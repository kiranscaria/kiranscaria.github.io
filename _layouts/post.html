---
layout: default
---
{% assign reading_progress_enabled = site.features.reading_progress | default: true %}
{% if reading_progress_enabled %}
<div class="reading-progress" data-reading-progress role="progressbar" aria-label="Reading progress" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
  <span class="reading-progress-bar" data-reading-progress-bar></span>
</div>
{% endif %}

<article class="post-page">
  <header class="post-hero{% if page.background %} has-image{% endif %}"{% if page.background %} style="--hero-image: url('{{ page.background | relative_url }}');"{% endif %}>
    <div class="shell reveal" data-reveal>
      <a class="back-link" href="{{ '/posts' | relative_url }}">← Back to archive</a>
      <p class="eyebrow">{{ page.categories | first | default: 'Article' }}</p>
      <h1>{{ page.title }}</h1>
      {% if page.subtitle %}
        <p class="lead">{{ page.subtitle }}</p>
      {% endif %}
      <p class="post-hero-meta">
        <span>{{ page.date | date: "%B %-d, %Y" }}</span>
        <span>•</span>
        {% include read_time.html content=page.content %}
        <span>•</span>
        <span>{{ page.author | default: site.author }}</span>
      </p>

      {% if page.tags %}
      <div class="post-tags" aria-label="Post tags">
        {% for tag in page.tags %}
          <span class="pill">#{{ tag }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </header>

  <section class="post-content-wrap">
    <div class="shell post-layout-grid">
      <aside class="post-toc" data-post-toc-wrap>
        <p class="post-toc-title">On this page</p>
        <nav data-post-toc aria-label="Table of contents"></nav>
      </aside>

      <div class="post-main-column">
        <div class="post-content prose" data-post-content>
          {{ content }}
        </div>

        {% if page.comments %}
          <div class="comments-block">
            {% include discus.html %}
          </div>
        {% endif %}

        <nav class="post-pagination" aria-label="Post navigation">
          {% if page.previous.url %}
            <a class="post-pagination-link" href="{{ page.previous.url | relative_url }}">
              <small>Previous</small>
              <span>{{ page.previous.title }}</span>
            </a>
          {% endif %}
          {% if page.next.url %}
            <a class="post-pagination-link" href="{{ page.next.url | relative_url }}">
              <small>Next</small>
              <span>{{ page.next.title }}</span>
            </a>
          {% endif %}
        </nav>
      </div>
    </div>
  </section>
</article>

<section class="home-section home-section-muted related-section">
  <div class="shell">
    <div class="section-head">
      <div>
        <p class="section-label">Continue Reading</p>
        <h2>Related posts</h2>
      </div>
    </div>

    <div class="post-grid">
      {% assign related_count = 0 %}
      {% for post in site.posts %}
        {% if post.url != page.url %}
          {% assign has_shared_category = false %}
          {% for category in page.categories %}
            {% if post.categories contains category %}
              {% assign has_shared_category = true %}
            {% endif %}
          {% endfor %}
          {% if has_shared_category %}
            {% include post-card.html post=post excerpt_words=18 %}
            {% assign related_count = related_count | plus: 1 %}
            {% if related_count == 3 %}{% break %}{% endif %}
          {% endif %}
        {% endif %}
      {% endfor %}

      {% if related_count == 0 %}
        {% assign fallback_count = 0 %}
        {% for post in site.posts %}
          {% if post.url != page.url %}
            {% include post-card.html post=post excerpt_words=18 %}
            {% assign fallback_count = fallback_count | plus: 1 %}
            {% if fallback_count == 3 %}{% break %}{% endif %}
          {% endif %}
        {% endfor %}
      {% endif %}
    </div>
  </div>
</section>
